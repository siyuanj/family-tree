<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数字化家谱</title>
    <!-- 1. 加载 Google Charts 库 -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <!-- 2. 链接到你的 CSS 样式文件 -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <h1>数字化家谱</h1>

    <div class="main-container">
        <!-- [修改] 左侧控制面板，调整了内部元素的顺序 -->
        <div class="controls">
            <!-- 1. 成员详情面板（放到最上面） -->
            <div id="details-panel" class="panel-section">
                <h2>成员详情</h2>
                <div id="details-content"><p>请点击家谱中的任意成员进行操作。</p></div>
                <div id="details-actions" class="action-btn-group" style="margin-top: 15px;"></div>
            </div>

            <!-- 2. 添加新成员面板 -->
            <div id="add-member-panel" class="panel-section">
                <h2>添加新成员</h2>
                <div class="form-group"><label for="newName">姓名:</label><input type="text" id="newName"></div>
                <div class="form-group"><label for="newGender">性别:</label><select id="newGender"><option value="male">男</option><option value="female">女</option></select></div>
                <div class="form-group"><label for="newInfo">生平信息:</label><input type="text" id="newInfo" placeholder="例如：19xx - 20xx"></div>
                <div class="form-group"><label for="newFather">父亲:</label><select id="newFather"></select></div>
                <div class="form-group"><label for="newMother">母亲:</label><select id="newMother"></select></div>
                <div class="form-group"><label for="newSpouse">配偶:</label><select id="newSpouse"></select></div>
                <div class="form-group"><label for="newTooltip">悬停提示:</label><textarea id="newTooltip" rows="3"></textarea></div>
                <div class="form-group"><button id="addBtn">添加到家谱</button></div>
            </div>
        </div>

        <!-- [修改] 右侧图表容器，将按钮组移入其中 -->
        <div id="chart_div_container">
            <!-- 1. 新增一个包裹层，专门用于定位 -->
            <div class="chart-wrapper">
                <div id="orgchart_div"></div>
                <div id="timeline_div" style="display: none;"></div>
            </div>
            
            <!-- 2. 数据管理按钮组（现在是 chart-wrapper 的兄弟） -->
            <div id="data-management-panel" class="chart-overlay-panel top-right">
                <div class="action-btn-group">
                    <label for="import-file" class="action-btn">导入</label>
                    <input type="file" id="import-file" accept=".json" style="display: none;">
                    <button id="exportBtn" class="action-btn">导出</button>
                    <button id="resetBtn" class="action-btn">重置</button>
                </div>
            </div>

            <!-- 3. 视图切换按钮组（现在是 chart-wrapper 的兄弟） -->
            <div id="view-switch-panel" class="chart-overlay-panel bottom-right">
                <div class="action-btn-group">
                    <button id="orgchart-view-btn" class="action-btn active" onclick="switchView('orgchart')">家谱</button>
                    <button id="timeline-view-btn" class="action-btn" onclick="switchView('timeline')">时间轴</button>
                    <button class="action-btn" onclick="print()">打印</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- [新增] 主题切换面板 -->
    <div id="theme-switcher">
        <button class="theme-btn" data-theme="light" title="亮色模式">☀️</button>
        <button class="theme-btn" data-theme="dark" title="暗色模式">🌙</button>
        <button class="theme-btn" data-theme="sepia" title="怀旧模式">📜</button>
    </div>
    <!-- 编辑弹窗 (补充完整内容) -->
    <div id="editModal" class="modal-overlay">
        <div class="modal-content">
            <h2>编辑成员信息</h2>
            <input type="hidden" id="editId">
            <div class="form-group"><label for="editName">姓名:</label><input type="text" id="editName"></div>
            <div class="form-group"><label for="editGender">性别:</label><select id="editGender"><option value="male">男</option><option value="female">女</option></select></div>
            <div class="form-group"><label for="editInfo">生平信息:</label><input type="text" id="editInfo"></div>
            <div class="form-group"><label for="editFather">父亲:</label><select id="editFather"></select></div>
            <div class="form-group"><label for="editMother">母亲:</label><select id="editMother"></select></div>
            <div class="form-group"><label for="editSpouse">配偶:</label><select id="editSpouse"></select></div>
            <div class="form-group"><label for="editTooltip">悬停提示:</label><textarea id="editTooltip" rows="3"></textarea></div>
            <div class="modal-actions"><button id="saveBtn">保存</button><button id="cancelBtn">取消</button></div>
        </div>
    </div>

    <!-- 脚本加载 (保持不变) -->
    <script src="data.js"></script>
    <script src="script.js"></script>
</body>
</html>